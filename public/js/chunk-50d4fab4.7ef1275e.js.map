{"version":3,"sources":["webpack:///./src/views/build.tsx","webpack:///./src/views/list.tsx","webpack:///./src/views/logDialog.tsx"],"names":["defineComponent","props","projectName","type","String","branch","buildDailogVisible","Boolean","default","emits","closeDialog","setup","emit","state","reactive","formData","install","shell","shellContent","publish","pubTargetIp","pubTargetProt","pubTargetDir","pubTargetUser","pubTargetPwd","rules","required","message","trigger","logProjectName","dialogFormVisible","handler","closeLogDialog","build","then","res","ElMessage","data","content","getShellContent","apiGetShellContent","_createVNode","_Fragment","_resolveComponent","$event","width","color","_createTextVNode","footer","LogDialog","tableData","targetUrl","useToken","loading","formLoading","tabLoading","buildProjectName","handleCreate","methods","createProject","handleDialog","fetchData","catch","flag","beforeBuild","row","delete","deleteProject","k","key","getProjects","onMounted","onClick","_withDirectives","_resolveDirective","Build","onCloseDialog","logContent","ref","eventSourceRef","eventSource","value","EventSource","onmessage","event","replace","onerror","_eventSourceRef$value","close"],"mappings":"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","file":"js/chunk-50d4fab4.7ef1275e.js","sourcesContent":["import { defineComponent, reactive } from 'vue'\r\n\r\nimport { getShellContent as apiGetShellContent, build } from '../api'\r\nimport { ElMessage } from 'element-plus'\r\nimport LogDialog from './logDialog'\r\n\r\nexport default defineComponent({\r\n\r\n  props: {\r\n    projectName: { type: String },\r\n    branch: { type: String },\r\n    buildDailogVisible: { type: Boolean, default: false }\r\n  },\r\n\r\n  emits: {\r\n    closeDialog: () => true\r\n  },\r\n\r\n  setup(props, { emit }) {\r\n\r\n    const state = reactive({\r\n      formData: {\r\n        install: true,\r\n\r\n        branch: props.branch,\r\n\r\n        shell: false,\r\n        shellContent: '',\r\n\r\n        publish: false,\r\n        pubTargetIp: '',\r\n        pubTargetProt: '',\r\n        pubTargetDir: '',\r\n        pubTargetUser: '',\r\n        pubTargetPwd: ''\r\n      },\r\n\r\n      rules: {\r\n        branch: [{ required: true, message: 'Please enter the branch', trigger: 'change' }],\r\n        shellContent: [{ required: true, message: 'Please enter the shell content', trigger: 'change' }],\r\n        pubTargetIp: [{ required: true, message: 'Please enter the target ip', trigger: 'change' }],\r\n        pubTargetProt: [{ required: true, message: 'Please enter the target port', trigger: 'change' }],\r\n        pubTargetDir: [{ required: true, message: 'Please enter the target dir', trigger: 'change' }],\r\n        pubTargetUser: [{ required: true, message: 'Please enter the target user', trigger: 'change' }],\r\n        pubTargetPwd: [{ required: true, message: 'Please enter the target pwd', trigger: 'change' }],\r\n      },\r\n      \r\n      logProjectName: '',\r\n      dialogFormVisible: false\r\n    })\r\n\r\n    const handler = {\r\n      closeDialog: () => {\r\n        emit('closeDialog')\r\n      },\r\n\r\n      closeLogDialog: () => {\r\n        state.dialogFormVisible = false\r\n      },\r\n\r\n      build: () => {\r\n        build<string>({\r\n          ...state.formData,\r\n          projectName: props.projectName!\r\n        })\r\n          .then(res => {\r\n            ElMessage({\r\n              type: 'success',\r\n              message: res.data.message\r\n            })\r\n\r\n            state.logProjectName = res.data.content\r\n            state.dialogFormVisible = true\r\n          })\r\n      },\r\n\r\n      getShellContent: () => {\r\n        if (state.formData.shell) {\r\n          apiGetShellContent<string>(props.projectName!)\r\n            .then(res => {\r\n              state.formData.shellContent = res.data.content\r\n            })\r\n        }\r\n      }\r\n    }\r\n\r\n    return () => (\r\n      <>\r\n        <el-dialog v-model={props.buildDailogVisible} top=\"5vh\" width={800} title={`build ${props.projectName}`} v-slots={{\r\n          footer: () => <>\r\n            <div class=\"dialog-footer\">\r\n              <el-button onClick={handler.closeDialog}>Cancel</el-button>\r\n              <el-button type=\"primary\" onClick={handler.build}>\r\n                Build\r\n              </el-button>\r\n            </div>\r\n          </>\r\n        }}\r\n\r\n          before-close={handler.closeDialog}\r\n        >\r\n          <el-form model={state.formData} label-width={140} rules={state.rules} style={{ width: '700px' }}>\r\n\r\n            <el-form-item label=\"is Install：\">\r\n              <el-checkbox v-model={state.formData.install}></el-checkbox>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"Branch\">\r\n              <el-input v-model={state.formData.branch}></el-input>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"is Shell：\">\r\n              <el-checkbox v-model={state.formData.shell} onChange={handler.getShellContent}></el-checkbox>\r\n            </el-form-item>\r\n\r\n            {\r\n              state.formData.shell && (\r\n                <el-form-item label=\"shell content：\" prop=\"shellContent\">\r\n                  <span style={{ color: 'red' }}>ps: custom shell scripts will completely overwrite built-in commands</span>\r\n                  <el-input type=\"textarea\" v-model={state.formData.shellContent} rows={20}></el-input>\r\n                </el-form-item>\r\n              )\r\n            }\r\n\r\n            <el-form-item label=\"is Publish：\">\r\n              <el-checkbox v-model={state.formData.publish}></el-checkbox>\r\n            </el-form-item>\r\n            {\r\n              state.formData.publish && (\r\n              <>\r\n                <el-form-item label=\"publish IP：\" prop=\"pubTargetIp\">\r\n                  <el-input v-model={state.formData.pubTargetIp}></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"publish Port：\" prop=\"pubTargetProt\">\r\n                  <el-input v-model={state.formData.pubTargetProt}></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"publish Dir：\" prop=\"pubTargetDir\">\r\n                  <el-input v-model={state.formData.pubTargetDir}></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"publish User：\" prop=\"pubTargetUser\">\r\n                  <el-input v-model={state.formData.pubTargetUser}></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"publish Pwd：\" prop=\"pubTargetPwd\">\r\n                  <el-input v-model={state.formData.pubTargetPwd}></el-input>\r\n                </el-form-item>\r\n              </>\r\n              )\r\n            }\r\n          </el-form>\r\n        </el-dialog>\r\n\r\n        {\r\n          state.dialogFormVisible && (\r\n            <LogDialog \r\n              dialogFormVisible={ state.dialogFormVisible }\r\n              projectName={ state.logProjectName }\r\n              onCloseDialog={ handler.closeLogDialog }\r\n            />\r\n          )\r\n        }\r\n      </>\r\n    )\r\n  }\r\n})","import { defineComponent, onMounted, reactive } from \"vue\";\r\nimport { ElMessage } from \"element-plus\";\r\n\r\nimport { createProject, getProjects, deleteProject } from '../api'\r\nimport Build from './build'\r\n\r\nexport default defineComponent({\r\n  setup() {\r\n\r\n    const state = reactive({\r\n      tableData: [],\r\n\r\n      formData: {\r\n        projectName: '',\r\n        targetUrl: '',\r\n        useToken: true\r\n      },\r\n\r\n      loading: {\r\n        formLoading: false,\r\n        tabLoading: false\r\n      },\r\n\r\n      dialogFormVisible: false,\r\n      buildDailogVisible: false,\r\n      buildProjectName: {\r\n        projectName: '',\r\n        branch: ''\r\n      },\r\n\r\n      rules: {\r\n        projectName: [{ required: true, message: 'Please enter the git Project Name', trigger: 'change' }],\r\n        targetUrl: [{ required: true, message: 'Please enter the git Target Url', trigger: 'change', }]\r\n      }\r\n    })\r\n\r\n    const handler = {\r\n      handleCreate: () => {\r\n\r\n        methods.loading('form', true)\r\n\r\n        createProject(state.formData)\r\n          .then(() => {\r\n\r\n            ElMessage({ message: 'success!!', type: 'success' })\r\n\r\n            methods\r\n              .loading('form')\r\n\r\n            handler\r\n              .handleDialog(false)\r\n\r\n            methods\r\n              .fetchData()\r\n          })\r\n          .catch(() => methods.loading('form'))\r\n      },\r\n\r\n      handleDialog: (flag: boolean) => state.dialogFormVisible = flag,\r\n\r\n      beforeBuild: (row: { projectName: string, branch: string }) => {\r\n        \r\n        state.buildProjectName = row\r\n        state.buildDailogVisible = true\r\n      },\r\n\r\n      delete: (projectName: string) => {\r\n        methods.loading('tab', true)\r\n\r\n        deleteProject(projectName)\r\n          .then(() => {\r\n            methods.loading('tab')\r\n\r\n            methods.fetchData()\r\n          })\r\n          .catch(() => methods.loading('tab'))\r\n      }\r\n    }\r\n\r\n    const methods = {\r\n      loading: (k: string, flag: boolean = false) => {\r\n        const key = `${k}Loading`\r\n\r\n        state.loading[key as keyof { formLoading: boolean, tabLoading: boolean }] = flag\r\n      },\r\n\r\n      fetchData: () => {\r\n        methods.loading('tab', true)\r\n\r\n      getProjects<[]>()\r\n        .then(res => {\r\n\r\n          state.tableData = res.data.content || []\r\n          methods.loading('tab')\r\n\r\n        })\r\n        .catch(() => methods.loading('tab'))\r\n      }\r\n    }\r\n\r\n    onMounted(() => {\r\n      methods\r\n        .fetchData()\r\n      \r\n    })\r\n\r\n    return () => <div>\r\n      <el-button type=\"primary\" onClick={() => handler.handleDialog(true)}>add</el-button>\r\n      <el-table data={state.tableData} v-loading={ state.loading.tabLoading }>\r\n        <el-table-column prop=\"projectName\" label=\"Project Name\"  width=\"300\"/>\r\n        <el-table-column prop=\"branch\" label=\"Branch\"  width=\"100\"/>\r\n        <el-table-column prop=\"targetUrl\" label=\"Target Url\" />\r\n        <el-table-column label=\"operation\" width=\"180\"\r\n          v-slots={{\r\n            default: ({ row }:  { row: any } ) => <>\r\n              <el-button type=\"primary\" onClick={ () => handler.beforeBuild(row) }>build</el-button>\r\n              <el-button type=\"danger\" onClick={ () => handler.delete(row.projectName) }>del</el-button>\r\n            </>\r\n          }}\r\n        />\r\n      </el-table>\r\n\r\n      <el-dialog v-model={state.dialogFormVisible} title=\"Create Project\" width=\"500\"\r\n        v-slots={{\r\n          footer: () => <>\r\n            <div class=\"dialog-footer\">\r\n              <el-button onClick={() => handler.handleDialog(false)}>Cancel</el-button>\r\n              <el-button type=\"primary\" onClick={handler.handleCreate}>\r\n                Confirm\r\n              </el-button>\r\n            </div>\r\n          </>\r\n        }}\r\n      >\r\n        <el-form model={state.formData} label-width={140} rules={state.rules} v-loading={ state.loading.formLoading }>\r\n          <el-form-item label=\"Project Name\" prop=\"projectName\">\r\n            <el-input v-model={state.formData.projectName} clearable />\r\n          </el-form-item>\r\n          <el-form-item label=\"Target Url\" prop=\"targetUrl\" >\r\n            <el-input v-model={state.formData.targetUrl} clearable />\r\n          </el-form-item>\r\n          <el-form-item label=\"Use Git Config\" prop=\"useToken\" >\r\n            <el-checkbox v-model={state.formData.useToken}></el-checkbox>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-dialog>\r\n      \r\n      { state.buildDailogVisible && (\r\n        <Build\r\n          buildDailogVisible={ state.buildDailogVisible }\r\n          projectName={ state.buildProjectName.projectName }\r\n          branch={ state.buildProjectName.branch }\r\n          onCloseDialog={ () => ( state.buildDailogVisible = false ) }\r\n        />\r\n      ) }\r\n      \r\n    </div>\r\n  }\r\n})","import { defineComponent, onMounted, ref } from \"vue\";\r\n\r\nexport default defineComponent({\r\n\r\n  props: {\r\n    dialogFormVisible: { type: Boolean, default: false },\r\n    projectName: { type: String }\r\n  },\r\n\r\n  emits: {\r\n    closeDialog: () => true\r\n  },\r\n\r\n  setup(props, { emit }) {\r\n\r\n    const logContent = ref<string>('')\r\n    const eventSourceRef = ref<EventSource | null>(null)\r\n\r\n    onMounted(() => {\r\n      const eventSource =\r\n        eventSourceRef.value =\r\n        new EventSource(`/api/get_log?projectName=${props.projectName}`)\r\n\r\n      eventSource.onmessage = (event) => {\r\n        logContent.value = `${event.data}`.replace(/<br>/g, '\\n')\r\n      }\r\n\r\n      eventSource.onerror = () => {\r\n        logContent.value = 'error'\r\n      }\r\n    })\r\n\r\n    const handler = {\r\n      closeDialog: () => {\r\n        eventSourceRef.value?.close()\r\n\r\n        emit('closeDialog')\r\n      }\r\n    }\r\n\r\n    return () => (\r\n      <el-dialog v-model={props.dialogFormVisible} title=\"Build Logs\" width=\"80%\" top=\"5vh\"\r\n        before-close={handler.closeDialog}\r\n        v-slots={{\r\n          footer: () => <>\r\n            <div class=\"dialog-footer\">\r\n              <el-button onClick={handler.closeDialog}>Cancel</el-button>\r\n            </div>\r\n          </>\r\n        }}\r\n      >\r\n        <el-input type=\"textarea\" v-model={logContent.value} rows={30} readonly></el-input>\r\n      </el-dialog>\r\n    )\r\n  }\r\n})"],"sourceRoot":""}