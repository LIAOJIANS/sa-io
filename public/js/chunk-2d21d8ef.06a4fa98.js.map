{"version":3,"sources":["webpack:///./src/views/tagsDialog.tsx"],"names":["defineComponent","props","tagsProjectName","type","String","tagsDialog","Boolean","emits","closeDialog","setup","emit","state","reactive","tableData","loading","handler","delete","tagName","delTagByName","then","res","ElMessage","message","methods","fetchData","catch","getTags","data","content","map","c","item","split","branch","length","commitId","onMounted","_createVNode","_resolveComponent","$event","default","_withDirectives","row","_Fragment","onClick","_createTextVNode","_resolveDirective","footer"],"mappings":"+JAIeA,0CAAgB,CAE7BC,MAAO,CACLC,gBAAiB,CAAEC,KAAMC,QACzBC,WAAY,CAAEF,KAAMG,UAGtBC,MAAO,CACLC,YAAaA,KAAM,GAGrBC,MAAMR,GAAO,KAAES,IAEb,MAAMC,EAAQC,sBAAS,CACrBC,UAAW,GACXC,SAAS,IAMLC,EAAU,CACdP,YAAaA,IAAME,EAAK,eAExBM,OAASC,IACPN,EAAMG,SAAU,EAChBI,eAAiBD,GACdE,KAAKC,IACJC,eAAU,CAAEC,QAAS,YAAanB,KAAM,YACxCQ,EAAMG,SAAU,EAEhBS,EAAQC,cAETC,MAAM,IAAQd,EAAMG,SAAU,KAI/BS,EAAU,CACdC,YACEb,EAAMG,SAAU,EAEhBY,eAAkBzB,EAAMC,iBACrBiB,KAAKC,IAEJT,EAAME,UAAYO,EAAIO,KAAKC,QAAQC,IAAIC,IACrC,MAAMC,EAAOD,EAAEE,MAAM,KAErB,MAAO,CACLf,QAAShB,EAAMC,gBACf+B,OAAQF,EAAKA,EAAKG,OAAS,GAC3BC,SAAUJ,EAAKA,EAAKG,OAAS,MAIjCvB,EAAMG,SAAU,IAEjBW,MAAM,IAAQd,EAAMG,SAAU,KAQrC,OAJAsB,uBAAU,KACRb,EAAQC,cAGH,IAAAa,yBAAAC,8BAAC,aAAD,YACerC,EAAMI,WAAU,sBAAAkC,GAAhBtC,EAAMI,WAAUkC,EAAA,MAAYtC,EAAMC,gBAAT,YAAmC,qCAChEa,EAAQP,aAAW,CAAAgC,YAAA,CAAAC,4BAAAJ,yBAAAC,8BAAA,kBAUxB3B,EAAME,UAAS,yBAAA2B,YAAA,CAAAH,yBAAAC,8BAAA,2DAAAD,yBAAAC,8BAAA,oEAAAD,yBAAAC,8BAAA,4DAAAD,yBAAAC,8BAAA,mDASb,CACPE,QAASA,EAAGE,SAAoBL,yBAAAM,cAAA,MAAAN,yBAAAC,8BAAA,oCACKM,IAAM7B,EAAQC,OAAO,GAAG0B,EAAIzB,WAAWyB,EAAIT,UAAUS,EAAIP,aAAW,CAAAK,YAAA,CAAAK,6BAAA,iBAE1G,EAAAC,8BAAA,WAZWnC,EAAMG,YATlBiC,OAAQA,IAAAV,yBAAAM,cAAA,MAAAN,yBAAC,MAAD,yBAAAA,yBAAAC,8BAAC,aAAD,SAEgBvB,EAAQP,aAAW,CAAAgC,YAAA,CAAAK,6BAAA","file":"js/chunk-2d21d8ef.06a4fa98.js","sourcesContent":["import { defineComponent, onMounted, reactive } from \"vue\";\r\nimport { delTagByName, getTags } from '../api'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default defineComponent({\r\n\r\n  props: {\r\n    tagsProjectName: { type: String },\r\n    tagsDialog: { type: Boolean }\r\n  },\r\n\r\n  emits: {\r\n    closeDialog: () => true\r\n  },\r\n\r\n  setup(props, { emit }) {\r\n\r\n    const state = reactive({\r\n      tableData: [],\r\n      loading: false\r\n    } as {\r\n      tableData: Record<string, string>[]\r\n      loading: boolean\r\n    })\r\n\r\n    const handler = {\r\n      closeDialog: () => emit('closeDialog'),\r\n\r\n      delete: (tagName: string) => {\r\n        state.loading = true\r\n        delTagByName<{}>(tagName)\r\n          .then(res => {\r\n            ElMessage({ message: 'success!!', type: 'success' })\r\n            state.loading = false\r\n\r\n            methods.fetchData()\r\n          })\r\n          .catch(() => ( state.loading = false ))\r\n      }\r\n    }\r\n\r\n    const methods = {\r\n      fetchData() {\r\n        state.loading = true\r\n        \r\n        getTags<string[]>(props.tagsProjectName!)\r\n          .then(res => {\r\n\r\n            state.tableData = res.data.content.map(c => {\r\n              const item = c.split('-')\r\n\r\n              return {\r\n                tagName: props.tagsProjectName!,\r\n                branch: item[item.length - 2],\r\n                commitId: item[item.length - 1],\r\n              }\r\n            })\r\n            \r\n            state.loading = false\r\n          })\r\n          .catch(() => ( state.loading = false ))\r\n      }\r\n    }\r\n\r\n    onMounted(() => {\r\n      methods.fetchData()\r\n    })\r\n\r\n    return () => (\r\n      <el-dialog v-model={props.tagsDialog} title={`${props.tagsProjectName} Termianl`} width=\"50%\" top=\"5vh\"\r\n        before-close={handler.closeDialog}\r\n        v-slots={{\r\n          footer: () => <>\r\n            <div class=\"dialog-footer\">\r\n              <el-button onClick={handler.closeDialog}>Cancel</el-button>\r\n            </div>\r\n          </>\r\n        }}\r\n      >\r\n        <el-table\r\n          data={ state.tableData }\r\n          v-loading={ state.loading }\r\n          border\r\n          height=\"250\"\r\n        >\r\n          <el-table-column prop=\"tagName\" label=\"Tag Name\" />\r\n          <el-table-column prop=\"branch\" label=\"Branch\" width=\"140\" />\r\n          <el-table-column prop=\"commitId\" label=\"CommitId\" />\r\n          <el-table-column label=\"Operation\" width=\"100\"\r\n          v-slots={{\r\n            default: ({ row }:  { row: any } ) => <>\r\n              <el-button type=\"danger\" onClick={ () => handler.delete(`${row.tagName}-${row.branch}-${row.commitId}`) }>del</el-button>\r\n            </>\r\n          }}\r\n        />\r\n        </el-table>\r\n\r\n      </el-dialog>\r\n    )\r\n  }\r\n})"],"sourceRoot":""}