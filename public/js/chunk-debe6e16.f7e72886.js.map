{"version":3,"sources":["webpack:///./src/hooks/useRefs.ts","webpack:///./src/views/wsConfig.tsx"],"names":["useRefs","config","refs","shallowReactive","obj","key","undefined","onRef","refer","defineComponent","setup","state","reactive","formData","wsUrl","rules","required","message","trigger","loading","form","ElForm","handle","submit","_refs$form","validate","fild","setWsConfig","then","res","ElMessage","type","catch","onMounted","getWsConfig","data","content","_createVNode","_withDirectives","_resolveComponent","width","default","$event","_resolveDirective","textAlign","_createTextVNode"],"mappings":"kHAAA,kDAKc,SAAUA,EAAwCC,GAQ9D,MAAMC,EAAOC,6BAAgB,MAC3B,MAAMC,EAAM,GAEZ,IAAK,IAAIC,KAAOJ,EACdG,EAAIC,QAAOC,EAGb,OAAOF,GAPoB,IAUvBG,EAAQ,MACZ,MAAMH,EAAM,GACZ,IAAK,IAAIC,KAAOJ,EACdG,EAAIC,GAAQG,IAAiBN,EAAKG,GAAOG,GAE3C,OAAOJ,GALK,GAQd,MAAO,CACLF,OACAK,W,yGC3BWE,0CAAgB,CAC7BC,QAEE,MAAMC,EAAQC,sBAAS,CACrBC,SAAU,CACRC,MAAO,IAGTC,MAAO,CACLD,MAAO,CAAC,CAAEE,UAAU,EAAMC,QAAS,yBAA0BC,QAAS,YAGxEC,SAAS,KAGL,MAAEZ,EAAK,KAAEL,GAASF,eAAQ,CAC9BoB,KAAMC,SAGFC,EAAS,CACbC,OAAQA,KAAK,IAAAC,EACF,QAATA,EAAAtB,EAAKkB,YAAI,IAAAI,GAATA,EAAWC,SAASC,KACL,IAATA,IACFf,EAAMQ,SAAU,EAChBQ,eAAYhB,EAAME,UACfe,KAAKC,IACJC,eAAU,CAAEb,QAAS,YAAac,KAAM,YACxCpB,EAAMQ,SAAU,IAEjBa,MAAM,IAAOrB,EAAMQ,SAAU,QAiBxC,OAXAc,uBAAU,KAERtB,EAAMQ,SAAU,EAChBe,iBACGN,KAAKC,IACJlB,EAAME,SAAWgB,EAAIM,KAAKC,QAC1BzB,EAAMQ,SAAU,IAEjBa,MAAM,IAAOrB,EAAMQ,SAAU,KAG3B,IAAAkB,yBAAC,MAAD,MAAAC,4BAAAD,yBAAAE,8BAAC,WAAD,OAEI5B,EAAME,SAAQ,MAEdF,EAAMI,MAAK,2BAEX,CAAEyB,MAAO,SAAS,IACpBjC,EAAMa,MAAI,CAAAqB,YAAA,CAAAJ,yBAAAE,8BAAA,+CAAAE,YAAA,CAAAJ,yBAAAE,8BAAA,wBAGM5B,EAAME,SAASC,MAAK,sBAAA4B,GAApB/B,EAAME,SAASC,MAAK4B,EAAA,4BAAAC,8BAAA,WAP9BhC,EAAMQ,WAAOkB,yBAAA,aAWd,CAAEO,UAAW,SAAUJ,MAAO,UAAS,CAAAH,yBAAAE,8BAAA,oDAEJjB,EAAOC,QAAM,CAAAkB,YAAA,CAAAI,6BAAA","file":"js/chunk-debe6e16.f7e72886.js","sourcesContent":["import { Ref, shallowReactive } from \"vue\";\r\n\r\ntype RefValueType<V> = V extends { use: { ref: () => Ref<infer Refer | null> } } ? Refer :\r\n  V extends new (...args: any[]) => infer Refer ? Refer : V\r\n\r\nexport default function useRefs<T extends { [k: string]: any }>(config: T): {\r\n  refs: {\r\n    [k in keyof T]: RefValueType<T[k]> | null | undefined\r\n  },\r\n  onRef: {\r\n    [k in keyof T]: (val: any) => void\r\n  }\r\n} {\r\n  const refs = shallowReactive((() => {\r\n    const obj = {} as any\r\n\r\n    for (let key in config) {\r\n      obj[key] = undefined\r\n    }\r\n\r\n    return obj\r\n  })())\r\n\r\n  const onRef = (() => {\r\n    const obj = {} as any\r\n    for (let key in config) {\r\n      obj[key] = (refer: any) => { refs[key] = refer }\r\n    }\r\n    return obj\r\n  })()\r\n\r\n  return {\r\n    refs,\r\n    onRef\r\n  } as any\r\n}","import { defineComponent, onMounted, reactive } from \"vue\";\r\nimport { ElMessage, ElForm } from \"element-plus\";\r\n\r\nimport { getWsConfig, setWsConfig } from '../api'\r\nimport useRefs from \"../hooks/useRefs\";\r\n\r\nexport default defineComponent({\r\n  setup() {\r\n\r\n    const state = reactive({\r\n      formData: {\r\n        wsUrl: ''\r\n      },\r\n\r\n      rules: {\r\n        wsUrl: [{ required: true, message: 'Please enter the wsUrl', trigger: 'change' }],\r\n      },\r\n\r\n      loading: false\r\n    })\r\n\r\n    const { onRef, refs } = useRefs({\r\n      form: ElForm\r\n    })\r\n\r\n    const handle = {\r\n      submit: () => {\r\n        refs.form?.validate(fild => {\r\n          if (fild === true) {\r\n            state.loading = true\r\n            setWsConfig(state.formData)\r\n              .then(res => {\r\n                ElMessage({ message: 'success!!', type: 'success' })\r\n                state.loading = false\r\n              })\r\n              .catch(() => (state.loading = false))\r\n          }\r\n        })\r\n      }\r\n    }\r\n\r\n    onMounted(() => {\r\n\r\n      state.loading = true\r\n      getWsConfig<{ wsUrl: string }>()\r\n        .then(res => {\r\n          state.formData = res.data.content\r\n          state.loading = false\r\n        })\r\n        .catch(() => (state.loading = false))\r\n    })\r\n\r\n    return () => <div>\r\n      <el-form\r\n        model={state.formData}\r\n        v-loading={state.loading}\r\n        rules={state.rules}\r\n        label-width=\"auto\"\r\n        style={{ width: '600px' }}\r\n        ref={onRef.form}\r\n      >\r\n        <el-form-item label=\"WS URL\" prop=\"wsUrl\">\r\n          <el-input v-model={state.formData.wsUrl}  clearable />\r\n        </el-form-item>\r\n      </el-form>\r\n\r\n      <div style={{ textAlign: 'center', width: '600px' }}>\r\n\r\n        <el-button el-button type=\"primary\" onClick={handle.submit}>保存</el-button>\r\n      </div>\r\n    </div>\r\n  }\r\n})"],"sourceRoot":""}